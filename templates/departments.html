{% extends "layout.html" %}

{% block content %}
<div class="container section-padding">
    <div class="text-center animate-on-scroll zoom-in">
        <h1 class="section-title">Academic Departments</h1>
        <p
            style="margin-bottom: 60px; color: var(--text-dim); max-width: 700px; margin-left: auto; margin-right: auto;">
            Our departments are responsible for the academic activities which include Teaching, Research, and Industrial
            Consultancy.
        </p>
    </div>

    <!-- Semester Update Banner -->
    <div class="animate-on-scroll fade-down" style="margin-bottom: 40px;">
        <div
            style="background: linear-gradient(90deg, rgba(14, 165, 233, 0.2), rgba(245, 158, 11, 0.1)); border: 1px solid var(--primary); padding: 15px 20px; border-radius: 12px; display: flex; align-items: center; gap: 15px;">
            <i class="fas fa-info-circle text-primary" style="font-size: 1.5rem;"></i>
            <div>
                <h4 style="margin: 0; color: var(--text-light);">New Semester Update</h4>
                <p style="margin: 0; font-size: 0.9rem; color: var(--text-dim);">Registration for the upcoming semester
                    is now open. Students are requested to complete their enrollment by Aug 15th.</p>
            </div>
        </div>
    </div>

    <!-- Quick Nav -->
    <div class="glass-card animate-on-scroll fade-up"
        style="transition-delay: 0.1s; padding: 20px; display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; margin-bottom: 80px; position: sticky; top: 90px; z-index: 100; backdrop-filter: blur(20px);">
        {% for dept in departments %}
        <a href="#{{ dept.id }}" class="btn btn-outline" style="border-radius: 20px; padding: 8px 25px;">{{
            dept.id|upper if dept.id|length <= 4 else dept.name|truncate(10, True, '' ) }}</a>
                {% endfor %}
    </div>

    {% for dept in departments %}
    <section id="{{ dept.id }}" style="margin-bottom: 100px; scroll-margin-top: 180px;"
        class="animate-on-scroll fade-up">
        <div class="glass-card" style="padding: 40px; border-left: 5px solid {{ dept.theme_color }};">
            <div
                style="display: flex; flex-wrap: wrap; justify-content: space-between; align-items: start; margin-bottom: 30px; gap: 20px;">
                <div>
                    <h2
                        style="color: var(--text-light); font-size: 2.5rem; display: flex; align-items: center; gap: 15px;">
                        <i class="{{ dept.icon }}" style="color: {{ dept.theme_color }};"></i> {{ dept.name }}
                    </h2>
                    <p style="color: var(--text-dim); margin-top: 10px; font-size: 1.1rem;">{{ dept.tagline }}</p>
                </div>
                <div style="text-align: right;">
                    <span
                        style="display: inline-block; padding: 8px 20px; background: rgba(255, 255, 255, 0.05); color: {{ dept.theme_color }}; border-radius: 30px; font-weight: 600; border: 1px solid {{ dept.theme_color }};">Intake:
                        {{ dept.intake }} Seats</span>
                </div>
            </div>

            <div class="grid-responsive" style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));">
                <div>
                    <h3
                        style="color: var(--text-light); margin-bottom: 20px; border-bottom: 1px solid var(--glass-border); padding-bottom: 10px;">
                        About the Department</h3>
                    <p style="color: var(--text-dim); margin-bottom: 20px; line-height: 1.8;">
                        {{ dept.description }}
                    </p>

                    {% if dept.vision or dept.mission %}
                    <div style="margin-bottom: 30px;">
                        <div
                            style="background: rgba(255,255,255,0.02); padding: 20px; border-radius: 10px; border: 1px solid var(--glass-border);">
                            <h4 style="color: {{ dept.theme_color }}; margin-bottom: 15px;"><i
                                    class="fas fa-bullseye"></i> Vision & Mission</h4>

                            <!-- Static for now, can be rolling if multiple items exist -->
                            {% if dept.vision %}
                            <div style="margin-bottom: 15px;">
                                <strong
                                    style="color: var(--text-light); display: block; margin-bottom: 5px;">Vision</strong>
                                <p style="font-size: 0.9rem; color: var(--text-dim); font-style: italic;">"{{
                                    dept.vision }}"</p>
                            </div>
                            {% endif %}
                            {% if dept.mission %}
                            <div>
                                <strong
                                    style="color: var(--text-light); display: block; margin-bottom: 5px;">Mission</strong>
                                <p style="font-size: 0.9rem; color: var(--text-dim);">{{ dept.mission }}</p>
                            </div>
                            {% endif %}

                            <!-- Future Vision Rolling Placeholder -->
                            <div class="rolling-text-container" style="margin-top: 20px; height: 30px;">
                                <div class="rolling-text-content">
                                    <p style="color: {{ dept.theme_color }}; font-weight: 500;">Innovating for 2026...
                                    </p>
                                    <p style="color: {{ dept.theme_color }}; font-weight: 500;">Building Future
                                        Leaders...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endif %}

                    {% if dept.labs %}
                    <h3 style="color: var(--text-light); margin-bottom: 20px;">Labs & Workshops</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                        {% for lab in dept.labs %}
                        <div class="glass-card"
                            style="padding: 15px; text-align: center; position: relative; overflow: hidden;">
                            {% if lab.image %}
                            <img src="{{ url_for('static', filename='images/labs/' + lab.image) }}" alt="{{ lab.name }}"
                                style="width: 100%; height: 100px; object-fit: cover; border-radius: 10px; margin-bottom: 10px; opacity: 0.8;">
                            {% endif %}

                            {% if lab.icon and not lab.image %}
                            <i class="{{ lab.icon }}"
                                style="font-size: 2rem; color: {{ lab.color }}; margin-bottom: 10px;"></i>
                            {% endif %}
                            <h5 style="margin: 0; position: relative; z-index: 1;">{{ lab.name }}</h5>
                            {% if lab.subtext %}
                            <span style="font-size: 0.8rem; color: var(--text-dim); position: relative; z-index: 1;">{{
                                lab.subtext }}</span>
                            {% endif %}
                        </div>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>

                <!-- HOD Profile -->
                <div class="glass-card" style="background: rgba(0,0,0,0.3); text-align: center; padding: 30px;">
                    <div
                        style="width: 120px; height: 120px; border-radius: 50%; margin: 0 auto 20px; overflow: hidden; border: 3px solid {{ dept.theme_color }};">
                        {% if dept.hod.image %}
                        <img src="{{ dept.hod.image if dept.hod.image.startswith('http') else url_for('static', filename='images/faculty/' + dept.hod.image) }}"
                            onerror="this.onerror=null;this.src='{{ url_for('static', filename='images/sbitm_logo.png') }}'"
                            alt="HOD" style="width: 100%; height: 100%; object-fit: cover;">
                        {% else %}
                        <img src="{{ url_for('static', filename='images/sbitm_logo.png') }}" alt="HOD"
                            style="width: 100%; height: 100%; object-fit: cover;">
                        {% endif %}
                    </div>
                    <h3 style="color: var(--text-light); margin-bottom: 5px;">{{ dept.hod.name }}</h3>
                    <p style="color: {{ dept.theme_color }}; font-size: 0.9rem; margin-bottom: 15px;">{{ dept.hod.role
                        }}</p>
                    {% if dept.hod.quote %}
                    <p style="color: var(--text-dim); font-size: 0.9rem; font-style: italic; margin-bottom: 20px;">
                        "{{ dept.hod.quote }}"
                    </p>
                    {% endif %}
                    {% if dept.hod.faculty_id %}
                    <a href="{{ url_for('faculty_detail', id=dept.hod.faculty_id) }}"
                        class="btn btn-sm btn-outline">View Faculty Profile</a>
                    {% else %}
                    <a href="#" class="btn btn-sm btn-outline disabled">Profile Unavailable</a>
                    {% endif %}
                </div>
            </div>
        </div>
    </section>
    {% endfor %}

</div>
{% endblock %}